<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Andrey Metrostroi Server</title>

<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Russo+One&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box}

body{
    width:100vw;
    height:100vh;
    overflow:hidden;
    background:#000;
    font-family:'Orbitron',sans-serif;
}

/* Фон */
.bg{
    position:absolute;
    inset:0;
    width:100%;
    height:100%;
    object-fit:cover;
}

/* Заголовок */
.title{
    position:absolute;
    top:20px;
    left:50%;
    transform:translateX(-50%);
    font-family:'Russo One',sans-serif;
    font-size:56px;
    color:black;
    -webkit-text-stroke:2px white;
    text-shadow:0 0 15px rgba(255,255,255,.8);
}

/* Игрок */
.player{
    position:absolute;
    top:20px;
    right:20px;
    display:flex;
    align-items:center;
    gap:12px;
    background:rgba(0,0,0,.6);
    padding:10px 14px;
    border-radius:12px;
}

.player img{
    width:64px;
    height:64px;
    border-radius:8px;
}

.player .name{
    color:#7CFC00;
    font-size:14px;
}

/* Загрузка */
.loader{
    position:absolute;
    bottom:50px;
    left:50%;
    transform:translateX(-50%);
    width:700px;
}

.bar{
    height:30px;
    border-radius:15px;
    overflow:hidden;
    background:rgba(255,255,255,.15);
    border:2px solid rgba(255,255,255,.4);
}

.progress{
    height:100%;
    width:0%;
    background:linear-gradient(90deg,#bceb5c,#4ab574);
    display:flex;
    align-items:center;
    justify-content:center;
    transition:width .15s linear;
}

.progress span{
    color:white;
    font-weight:900;
    text-shadow:2px 2px 4px rgba(0,0,0,.8);
}
</style>
</head>

<body>

<img src="./background.jpg" class="bg">

<div class="title">Andrey Metrostroi Server</div>

<div class="player">
    <img id="avatar" src="./avatar_placeholder.png">
    <div class="name" id="playerName">Загрузка...</div>
</div>

<div class="loader">
    <div class="bar">
        <div class="progress" id="progress">
            <span id="percent">0%</span>
        </div>
    </div>
</div>

<script>
/* ================= URL PARAMS ================= */

const params = new URLSearchParams(window.location.search);
const steamid = params.get("steamid");
const name = params.get("name");

if(name){
    document.getElementById("playerName").textContent = decodeURIComponent(name);
}

if(steamid){
    document.getElementById("avatar").src =
        "https://steamcommunity.com/profiles/" + steamid + "/avatar";
}

/* ================= GMOD PROGRESS ================= */

let total = 0;
let needed = 0;
let smoothPercent = 0;

function update(){
    if(total <= 0) return;

    const real = ((total - needed) / total) * 100;
    smoothPercent += (real - smoothPercent) * 0.15;

    const p = Math.floor(smoothPercent);
    document.getElementById("progress").style.width = p + "%";
    document.getElementById("percent").textContent = p + "%";
}

window.SetFilesTotal = t => total = t;
window.SetFilesNeeded = n => { needed = n; update(); };

setInterval(update, 50);
</script>

</body>
</html>
