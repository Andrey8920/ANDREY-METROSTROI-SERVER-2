<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Andrey Metrostroi Server</title>

<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Press+Start+2P&family=Russo+One&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box}

body{
    width:100vw;
    height:100vh;
    overflow:hidden;
    background:#000;
    font-family:'Orbitron',sans-serif;
}

/* Фон */
.bg{
    position:absolute;
    inset:0;
    width:100%;
    height:100%;
    object-fit:cover;
}

/* Заголовок */
.title{
    position:absolute;
    top:20px;
    left:50%;
    transform:translateX(-50%);
    font-family:'Russo One',sans-serif;
    font-size:56px;
    color:black;
    -webkit-text-stroke:2px white;
    text-shadow:0 0 15px rgba(255,255,255,.8);
}

/* Название карты */
.map{
    position:absolute;
    bottom:20px;
    left:20px;
    font-family:'Press Start 2P',cursive;
    font-size:14px;
    color:black;
    text-shadow:2px 2px 0 rgba(255,255,255,.85);
}

/* Загрузка */
.loader{
    position:absolute;
    bottom:50px;
    left:50%;
    transform:translateX(-50%);
    width:700px;
}

.bar{
    height:30px;
    border-radius:15px;
    overflow:hidden;
    background:rgba(255,255,255,.15);
    border:2px solid rgba(255,255,255,.4);
}

.progress{
    height:100%;
    width:0%;
    background:linear-gradient(90deg,#bceb5c,#4ab574);
    display:flex;
    align-items:center;
    justify-content:center;
}

.progress span{
    color:white;
    font-weight:900;
    text-shadow:2px 2px 4px rgba(0,0,0,.8);
}
</style>
</head>

<body>

<img src="./background.jpg" class="bg">

<div class="title">Andrey Metrostroi Server</div>

<!-- Карта -->
<div class="map" id="mapName">Загрузка карты...</div>

<!-- Загрузка -->
<div class="loader">
    <div class="bar">
        <div class="progress" id="progress">
            <span id="percent">0%</span>
        </div>
    </div>
</div>

<!-- Музыка -->
<audio id="music" autoplay loop>
    <source src="https://raw.githubusercontent.com/Andrey8920/ANDREY-METROSTROI-SERVER-2/refs/heads/main/music.mp3" type="audio/mpeg">
</audio>

<script>
/* ===== Плавный прогресс (без дёрганья) ===== */

let total = 0;
let needed = 0;
let smooth = 0;

function updateProgress(){
    if(total <= 0) return;

    const real = ((total - needed) / total) * 100;
    smooth += (real - smooth) * 0.12;

    const p = Math.floor(smooth);
    document.getElementById("progress").style.width = p + "%";
    document.getElementById("percent").textContent = p + "%";
}

window.SetFilesTotal = t => total = t;
window.SetFilesNeeded = n => needed = n;

window.GameDetails = function(
    servername,
    serverurl,
    mapname
){
    document.getElementById("mapName").textContent = mapname;
};

setInterval(updateProgress, 50);

/* Фикс автоплея Chromium */
const music = document.getElementById("music");
music.volume = 0.3;
music.play().catch(()=>{
    document.addEventListener("click",()=>music.play(),{once:true});
});
</script>

</body>
</html>
